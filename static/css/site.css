/* ======================================================
   Siddur Sefardi — BOOK UI (single source of truth)
   Comfortable, minimal, elegant, practical on mobile
   ====================================================== */

:root{
  --bg:#ffffff;
  --fg:#111111;
  --muted:#7a7a7a;
  --border:#e7e7e7;
  --link:#0b57d0;

  --maxw: 760px;
  --pad: 16px;

  --font: 20px;          /* bigger by default */
  --line: 1.9;

  --he-font: "David Libre","Noto Serif Hebrew","Noto Sans Hebrew",serif;
  --ui-font: system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;

  --topbar-h: 72px;
  --bottombar-h: 72px;
}

/* Base */
html,body{height:100%;}
body{
  margin:0;
  background:var(--bg);
  color:var(--fg);
  font-family:var(--he-font);
  font-size:var(--font);
  line-height:var(--line);
  text-rendering:optimizeLegibility;
  -webkit-text-size-adjust:100%;
}

a{ color:var(--link); text-decoration:none; }
a:hover{ text-decoration:underline; }

/* Content column */
.page{
  max-width:var(--maxw);
  margin:0 auto;
  padding: calc(var(--pad) + 10px) var(--pad);
  padding-bottom: calc(var(--bottombar-h) + 34px + env(safe-area-inset-bottom));
  direction:rtl;
  unicode-bidi:plaintext;
}

/* Typography */
.page h1{
  font-size:1.65em;
  margin:0.9em 0 0.25em;
  font-weight:650;
  letter-spacing:.2px;
}
.page h2{
  font-size:1.12em;
  margin:1.4em 0 0.35em;
  font-weight:600;
  color:var(--muted);
}
.page p{ margin:0.65em 0; }
.page hr{
  border:0;
  border-top:1px solid var(--border);
  margin:1.15em 0;
}

/* ======================================================
   TOPBAR — spaced, not glued, finger-friendly
   ====================================================== */

header.topbar{
  position: sticky;
  top: 0;
  z-index: 200;
  height: var(--topbar-h);

  background: rgba(255,255,255,.96);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--border);

  display:flex;
  align-items:center;
}

/* Your current HTML is:
   <header class="topbar">
     <div class="brand">...</div>
     <nav class="controls">...</nav>
   </header>
   There is no .inner — so we style header directly.
*/
header.topbar{
  max-width: var(--maxw);
  margin: 0 auto;
  padding: 0 var(--pad);
  box-sizing: border-box;

  display:flex;
  justify-content: space-between;
  align-items: center;
  gap: 16px;
}

/* Brand: title + byline */
header.topbar .brand{
  display:flex;
  flex-direction: column;
  gap: 4px;
  line-height: 1.1;
  text-align: right;
  font-family: var(--ui-font);
}

header.topbar .brand .title{
  font-size: 18px;
  font-weight: 650;
  color: var(--fg);
}

header.topbar .brand .byline{
  font-size: 14px;
  color: var(--muted);
}

header.topbar .brand .byline a{
  color: inherit;
  text-decoration: none;
}
header.topbar .brand .byline a:hover{
  text-decoration: underline;
}

/* Controls: big targets, not stuck to edge */
nav.controls{
  display:flex;
  align-items:center;
  gap: 12px;
}

nav.controls .btn{
  appearance:none;
  border:0;
  background:transparent;

  width: 48px;
  height: 48px;
  display:inline-flex;
  align-items:center;
  justify-content:center;

  font-family: var(--ui-font);
  font-size: 20px;
  font-weight: 650;
  color: var(--muted);

  border-radius: 14px;
  cursor:pointer;
}

nav.controls .btn:hover{ color: var(--fg); }
nav.controls .btn:focus-visible{
  outline:2px solid rgba(17,17,17,.25);
  outline-offset:2px;
}

/* ======================================================
   BOTTOMBAR — 3 equal thirds, larger text, single line
   ====================================================== */

nav.bottombar{
  position: fixed;
  left: 0; right: 0; bottom: 0;
  z-index: 220;

  background: rgba(255,255,255,.96);
  backdrop-filter: blur(10px);
  border-top: 1px solid var(--border);

  height: calc(var(--bottombar-h) + env(safe-area-inset-bottom));
  padding-bottom: env(safe-area-inset-bottom);

  display:grid;
  grid-auto-flow: column;
  grid-auto-columns: 1fr;

  max-width: var(--maxw);
  margin: 0 auto;
  padding-left: var(--pad);
  padding-right: var(--pad);
  box-sizing: border-box;
}

nav.bottombar a.bbtn{
  position: relative;
  height: var(--bottombar-h);

  display:flex;
  align-items:center;
  justify-content:center;

  font-family: var(--he-font);
  font-size: 20px;
  font-weight: 650;

  color: var(--muted);
  text-decoration:none;
}

/* Active: one clean line (top of its third) */
nav.bottombar a.bbtn.active{
  color: var(--fg);
}
nav.bottombar a.bbtn.active::before{
  content:"";
  position:absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 2px;
  background: var(--fg);
}

/* ======================================================
   Hide UI while reading (JS toggles body.ui-hidden)
   ====================================================== */
header.topbar, nav.bottombar{
  transition: transform .18s ease;
}
body.ui-hidden header.topbar{ transform: translateY(-110%); }
body.ui-hidden nav.bottombar{ transform: translateY(110%); }

/* Mobile tuning */
@media (max-width:520px){
  :root{
    --pad: 14px;
    --font: 19px;
    --topbar-h: 76px;
    --bottombar-h: 72px;
  }
  header.topbar .brand .title{ font-size: 17px; }
  header.topbar .brand .byline{ font-size: 13px; }
  nav.bottombar a.bbtn{ font-size: 19px; }
}

/* ======================================================
   FINAL UI FIX — oxygen + no double bar + practical sizing
   (Overrides anything above)
   ====================================================== */

/* More comfortable base sizes on mobile */
:root{
  --pad: 18px;
  --maxw: 760px;
  --topbar-h: 72px;
  --bottombar-h: 72px;
}

/* ---------- TOPBAR: give oxygen, keep controls away from edge ---------- */
header.topbar{
  height: var(--topbar-h);
  background: rgba(255,255,255,.96);
  backdrop-filter: blur(10px);

  /* Remove the “double line” feeling */
  border-bottom: none;
  box-shadow: 0 1px 0 var(--border);

  /* Full-width bar but content “book-centered” using smart padding */
  padding-inline: max(var(--pad), calc((100vw - var(--maxw)) / 2));
  padding-block: 10px;

  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 16px;
  box-sizing: border-box;
}

/* Brand not glued to the right */
header.topbar .brand{
  margin-right: 6px;
  gap: 4px;
}

/* Make title/byline readable but not loud */
header.topbar .brand .title{ font-size: 18px; font-weight: 650; }
header.topbar .brand .byline{ font-size: 14px; }

/* Controls: bigger tap targets + breathing room */
nav.controls{ gap: 12px; }
nav.controls .btn{
  width: 48px;
  height: 48px;
  font-size: 20px;
  border-radius: 14px;
}

/* ---------- CONTENT: ensure it never feels glued under topbar ---------- */
.page{
  padding-top: calc(var(--pad) + 18px);
  padding-bottom: calc(var(--bottombar-h) + 40px + env(safe-area-inset-bottom));
}

/* ---------- BOTTOMBAR: full-width, text not glued to bottom, no double bar ---------- */
nav.bottombar{
  /* keep fixed */
  position: fixed;
  left: 0; right: 0; bottom: 0;
  z-index: 220;

  height: calc(var(--bottombar-h) + env(safe-area-inset-bottom));

  /* oxygen: top/bottom padding */
  padding-top: 10px;
  padding-bottom: calc(14px + env(safe-area-inset-bottom));

  /* full width background */
  background: rgba(255,255,255,.96);
  backdrop-filter: blur(10px);

  /* remove border-top to avoid “double bar” */
  border-top: none;
  box-shadow: 0 -1px 0 var(--border);

  /* book-centered content (important!) */
  padding-inline: max(var(--pad), calc((100vw - var(--maxw)) / 2));

  box-sizing: border-box;

  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: 1fr;
  gap: 0;
  align-items: end;
}

/* Tabs: larger, minimal, centered */
nav.bottombar a.bbtn{
  height: var(--bottombar-h);
  display:flex;
  align-items:center;
  justify-content:center;

  font-size: 20px;
  font-weight: 650;
  color: var(--muted);
  text-decoration:none;

  position: relative;
}

/* Active: ONE line only, takes full width of its third */
nav.bottombar a.bbtn.active{
  color: var(--fg);
}
nav.bottombar a.bbtn.active::before{
  content:"";
  position:absolute;
  top: -10px;          /* place it above the text area so it doesn’t clash */
  left: 0;
  width: 100%;
  height: 2px;
  background: var(--fg);
  opacity: .9;
}

/* Mobile tweak: bigger text + more air */
@media (max-width:520px){
  :root{
    --pad: 16px;
    --topbar-h: 76px;
    --bottombar-h: 76px;
    --font: 20px;
  }
  nav.bottombar a.bbtn{ font-size: 21px; }
}

/* ---------- Hide UI while reading (JS toggles body.ui-hidden) ---------- */
header.topbar, nav.bottombar{ transition: transform .18s ease; }
body.ui-hidden header.topbar{ transform: translateY(-120%); }
body.ui-hidden nav.bottombar{ transform: translateY(120%); }
